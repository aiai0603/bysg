{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/menu/style\";\nimport _Menu from \"antd/lib/menu\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nvar _jsxFileName = \"C:\\\\Users\\\\asus\\\\Desktop\\\\bysg\\\\web\\\\myapp\\\\src\\\\components\\\\HeaderCustom.tsx\";\n\n/**\n * Created by hao.cheng on 2017/4/13.\n */\nimport React, { Component } from 'react';\nimport screenfull from 'screenfull';\nimport avater from '../style/imgs/admin.jpg';\nimport SiderCustom from './SiderCustom';\nimport { gitOauthToken, gitOauthInfo } from '../service';\nimport { queryString } from '../utils';\nimport { withRouter } from 'react-router-dom';\nimport { PwaInstaller } from './widget';\nimport { connectAlita } from 'redux-alita';\nimport umbrella from 'umbrella-storage';\nconst {\n  Header\n} = _Layout;\nconst SubMenu = _Menu.SubMenu;\nconst MenuItemGroup = _Menu.ItemGroup;\n\nclass HeaderCustom extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      user: '',\n      visible: false\n    };\n\n    this.screenFull = () => {\n      if (screenfull.isEnabled) {\n        screenfull.request();\n      }\n    };\n\n    this.menuClick = e => {\n      e.key === 'logout' && this.logout();\n    };\n\n    this.logout = () => {\n      umbrella.removeLocalStorage('user');\n      this.props.history.push('/login');\n    };\n\n    this.popoverHide = () => {\n      this.setState({\n        visible: false\n      });\n    };\n\n    this.handleVisibleChange = visible => {\n      this.setState({\n        visible\n      });\n    };\n  }\n\n  componentDidMount() {\n    const QueryString = queryString();\n    let storageUser = umbrella.getLocalStorage('user'); // _user = (storageUser && JSON.parse(storageUser)) || '测试';\n\n    if (!storageUser && QueryString.hasOwnProperty('code')) {\n      gitOauthToken(QueryString.code).then(res => {\n        gitOauthInfo(res.access_token).then(info => {\n          this.setState({\n            user: info\n          });\n          umbrella.setLocalStorage('user', info);\n        });\n      });\n    } else {\n      this.setState({\n        user: storageUser\n      });\n    }\n  }\n\n  render() {\n    const {\n      responsive\n    } = this.props;\n    return /*#__PURE__*/React.createElement(Header, {\n      className: \"custom-theme header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 13\n      }\n    }, responsive.data.isMobile ? /*#__PURE__*/React.createElement(_Popover, {\n      content: /*#__PURE__*/React.createElement(SiderCustom, {\n        popoverHide: this.popoverHide,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 34\n        }\n      }),\n      trigger: \"click\",\n      placement: \"bottomLeft\",\n      visible: this.state.visible,\n      onVisibleChange: this.handleVisibleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(_Icon, {\n      type: \"bars\",\n      className: \"header__trigger custom-trigger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 25\n      }\n    })) : /*#__PURE__*/React.createElement(_Icon, {\n      className: \"header__trigger custom-trigger\",\n      type: this.props.collapsed ? 'menu-unfold' : 'menu-fold',\n      onClick: this.props.toggle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(_Menu, {\n      mode: \"horizontal\",\n      style: {\n        lineHeight: '64px',\n        float: 'right'\n      },\n      onClick: this.menuClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(_Menu.Item, {\n      key: \"pwa\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(PwaInstaller, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(_Menu.Item, {\n      key: \"full\",\n      onClick: this.screenFull,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(_Icon, {\n      type: \"arrows-alt\",\n      onClick: this.screenFull,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(SubMenu, {\n      title: /*#__PURE__*/React.createElement(\"span\", {\n        className: \"avatar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: avater,\n        alt: \"\\u5934\\u50CF\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 33\n        }\n      }), /*#__PURE__*/React.createElement(\"i\", {\n        className: \"on bottom b-white\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 33\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(MenuItemGroup, {\n      title: \"\\u7528\\u6237\\u4E2D\\u5FC3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(_Menu.Item, {\n      key: \"setting:1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 29\n      }\n    }, \"\\u4F60\\u597D - \", this.props.user.userName), /*#__PURE__*/React.createElement(_Menu.Item, {\n      key: \"setting:2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      onClick: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 33\n      }\n    }, \"\\u4E2A\\u4EBA\\u4FE1\\u606F\")), /*#__PURE__*/React.createElement(_Menu.Item, {\n      key: \"logout\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      onClick: this.logout,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 33\n      }\n    }, \"\\u9000\\u51FA\\u767B\\u5F55\"))))));\n  }\n\n} // 重新设置连接之后组件的关联类型\n\n\nconst HeaderCustomConnect = connectAlita([{\n  responsive: {\n    isMobile: false\n  }\n}])(HeaderCustom);\nexport default withRouter(HeaderCustomConnect);","map":{"version":3,"sources":["C:/Users/asus/Desktop/bysg/web/myapp/src/components/HeaderCustom.tsx"],"names":["React","Component","screenfull","avater","SiderCustom","gitOauthToken","gitOauthInfo","queryString","withRouter","PwaInstaller","connectAlita","umbrella","Header","SubMenu","MenuItemGroup","ItemGroup","HeaderCustom","state","user","visible","screenFull","isEnabled","request","menuClick","e","key","logout","removeLocalStorage","props","history","push","popoverHide","setState","handleVisibleChange","componentDidMount","QueryString","storageUser","getLocalStorage","hasOwnProperty","code","then","res","access_token","info","setLocalStorage","render","responsive","data","isMobile","collapsed","toggle","lineHeight","float","userName","HeaderCustomConnect"],"mappings":"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","sourcesContent":["/**\n * Created by hao.cheng on 2017/4/13.\n */\nimport React, { Component } from 'react';\nimport screenfull from 'screenfull';\nimport avater from '../style/imgs/admin.jpg';\nimport SiderCustom from './SiderCustom';\nimport { Menu, Icon, Layout, Badge, Popover } from 'antd';\nimport { gitOauthToken, gitOauthInfo } from '../service';\nimport { queryString } from '../utils';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\nimport { PwaInstaller } from './widget';\nimport { connectAlita } from 'redux-alita';\nimport umbrella from 'umbrella-storage';\nconst { Header } = Layout;\nconst SubMenu = Menu.SubMenu;\nconst MenuItemGroup = Menu.ItemGroup;\n\ntype HeaderCustomProps = RouteComponentProps<any> & {\n    toggle: () => void;\n    collapsed: boolean;\n    user: any;\n    responsive?: any;\n    path?: string;\n};\ntype HeaderCustomState = {\n    user: any;\n    visible: boolean;\n};\n\nclass HeaderCustom extends Component<HeaderCustomProps, HeaderCustomState> {\n    state = {\n        user: '',\n        visible: false,\n    };\n    componentDidMount() {\n        const QueryString = queryString() as any;\n        let storageUser = umbrella.getLocalStorage('user');\n\n        // _user = (storageUser && JSON.parse(storageUser)) || '测试';\n        if (!storageUser && QueryString.hasOwnProperty('code')) {\n            gitOauthToken(QueryString.code).then((res: any) => {\n                gitOauthInfo(res.access_token).then((info: any) => {\n                    this.setState({\n                        user: info,\n                    });\n                    umbrella.setLocalStorage('user', info);\n                });\n            });\n        } else {\n            this.setState({\n                user: storageUser,\n            });\n        }\n    }\n    screenFull = () => {\n        if (screenfull.isEnabled) {\n            screenfull.request();\n        }\n    };\n    menuClick = (e: { key: string }) => {\n        e.key === 'logout' && this.logout();\n    };\n    logout = () => {\n        umbrella.removeLocalStorage('user');\n        this.props.history.push('/login');\n    };\n    popoverHide = () => {\n        this.setState({\n            visible: false,\n        });\n    };\n    handleVisibleChange = (visible: boolean) => {\n        this.setState({ visible });\n    };\n    render() {\n        const { responsive } = this.props;\n        return (\n            <Header className=\"custom-theme header\">\n                {responsive.data.isMobile ? (\n                    <Popover\n                        content={<SiderCustom popoverHide={this.popoverHide} />}\n                        trigger=\"click\"\n                        placement=\"bottomLeft\"\n                        visible={this.state.visible}\n                        onVisibleChange={this.handleVisibleChange}\n                    >\n                        <Icon type=\"bars\" className=\"header__trigger custom-trigger\" />\n                    </Popover>\n                ) : (\n                    <Icon\n                        className=\"header__trigger custom-trigger\"\n                        type={this.props.collapsed ? 'menu-unfold' : 'menu-fold'}\n                        onClick={this.props.toggle}\n                    />\n                )}\n                <Menu\n                    mode=\"horizontal\"\n                    style={{ lineHeight: '64px', float: 'right' }}\n                    onClick={this.menuClick}\n                >\n                    <Menu.Item key=\"pwa\">\n                        <PwaInstaller />\n                    </Menu.Item>\n                    <Menu.Item key=\"full\" onClick={this.screenFull}>\n                        <Icon type=\"arrows-alt\" onClick={this.screenFull} />\n                    </Menu.Item>\n                  \n                    <SubMenu\n                        title={\n                            <span className=\"avatar\">\n                                <img src={avater} alt=\"头像\" />\n                                <i className=\"on bottom b-white\" />\n                            </span>\n                        }\n                    >\n                        <MenuItemGroup title=\"用户中心\">\n                            <Menu.Item key=\"setting:1\">你好 - {this.props.user.userName}</Menu.Item>\n                            <Menu.Item key=\"setting:2\">\n                                <span onClick={this.logout}>个人信息</span>\n                            </Menu.Item>\n                            <Menu.Item key=\"logout\">\n                                <span onClick={this.logout}>退出登录</span>\n                            </Menu.Item>\n                        </MenuItemGroup>\n                      \n                    </SubMenu>\n                </Menu>\n            </Header>\n        );\n    }\n}\n\n// 重新设置连接之后组件的关联类型\nconst HeaderCustomConnect: React.ComponentClass<\n    HeaderCustomProps,\n    HeaderCustomState\n> = connectAlita([{ responsive: { isMobile: false } }])(HeaderCustom);\n\nexport default withRouter(HeaderCustomConnect);\n"]},"metadata":{},"sourceType":"module"}