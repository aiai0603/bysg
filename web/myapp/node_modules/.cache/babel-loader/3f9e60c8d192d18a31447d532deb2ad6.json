{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asus\\\\Desktop\\\\zucc-bysg\\\\web\\\\myapp\\\\src\\\\components\\\\widget\\\\PwaInstaller.tsx\";\n\n/*\r\n * File: PwaInstaller.js\r\n * Desc: pwa手动触发安装\r\n * File Created: 2018-11-07 21:13:18\r\n * Author: chenghao\r\n *\r\n * Copyright 2018 - present, chenghao\r\n */\nimport React, { Component } from 'react';\n\nclass PwaInstaller extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      installed: true\n    };\n    this.deferredPrompt = void 0;\n\n    this.beforeInstallPrompt = e => {\n      console.log('beforeinstallprompt Event fired'); // 未安装PWA应用\n\n      this.setState({\n        installed: false\n      });\n      e.preventDefault(); // Stash the event so it can be triggered later.\n\n      this.deferredPrompt = e;\n      return false;\n    };\n\n    this.download = () => {\n      if (this.deferredPrompt !== undefined) {\n        // The user has had a postive interaction with our app and Chrome\n        // has tried to prompt previously, so let's show the prompt.\n        this.deferredPrompt.prompt(); // Follow what the user has done with the prompt.\n\n        this.deferredPrompt.userChoice.then(choiceResult => {\n          console.log(choiceResult.outcome);\n\n          if (choiceResult.outcome === 'dismissed') {\n            console.log('User cancelled home screen install');\n          } else {\n            console.log('User added to home screen');\n          } // We no longer need the prompt.  Clear it up.\n\n\n          this.deferredPrompt = null;\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeinstallprompt', this.beforeInstallPrompt);\n  }\n\n  render() {\n    const {\n      installed\n    } = this.state;\n    return !installed && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"installer\",\n      onClick: this.download,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"installer__btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 21\n      }\n    }));\n  }\n\n}\n\nexport default PwaInstaller;","map":{"version":3,"sources":["C:/Users/asus/Desktop/zucc-bysg/web/myapp/src/components/widget/PwaInstaller.tsx"],"names":["React","Component","PwaInstaller","state","installed","deferredPrompt","beforeInstallPrompt","e","console","log","setState","preventDefault","download","undefined","prompt","userChoice","then","choiceResult","outcome","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render"],"mappings":";;AAAA;;;;;;;;AAQA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,MAAMC,YAAN,SAA2BD,SAA3B,CAAqC;AAAA;AAAA;AAAA,SACjCE,KADiC,GACzB;AACJC,MAAAA,SAAS,EAAE;AADP,KADyB;AAAA,SAUjCC,cAViC;;AAAA,SAWjCC,mBAXiC,GAWVC,CAAD,IAAc;AAChCC,MAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,EADgC,CAEhC;;AACA,WAAKC,QAAL,CAAc;AAAEN,QAAAA,SAAS,EAAE;AAAb,OAAd;AAEAG,MAAAA,CAAC,CAACI,cAAF,GALgC,CAMhC;;AACA,WAAKN,cAAL,GAAsBE,CAAtB;AACA,aAAO,KAAP;AACH,KApBgC;;AAAA,SAqBjCK,QArBiC,GAqBtB,MAAM;AACb,UAAI,KAAKP,cAAL,KAAwBQ,SAA5B,EAAuC;AACnC;AACA;AACA,aAAKR,cAAL,CAAoBS,MAApB,GAHmC,CAInC;;AACA,aAAKT,cAAL,CAAoBU,UAApB,CAA+BC,IAA/B,CAAqCC,YAAD,IAAuB;AACvDT,UAAAA,OAAO,CAACC,GAAR,CAAYQ,YAAY,CAACC,OAAzB;;AACA,cAAID,YAAY,CAACC,OAAb,KAAyB,WAA7B,EAA0C;AACtCV,YAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;AACH,WAFD,MAEO;AACHD,YAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH,WANsD,CAOvD;;;AACA,eAAKJ,cAAL,GAAsB,IAAtB;AACH,SATD;AAUH;AACJ,KAtCgC;AAAA;;AAIjCc,EAAAA,iBAAiB,GAAG;AAChBC,IAAAA,MAAM,CAACC,gBAAP,CAAwB,qBAAxB,EAA+C,KAAKf,mBAApD;AACH;;AACDgB,EAAAA,oBAAoB,GAAG;AACnBF,IAAAA,MAAM,CAACG,mBAAP,CAA2B,qBAA3B,EAAkD,KAAKjB,mBAAvD;AACH;;AA8BDkB,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEpB,MAAAA;AAAF,QAAgB,KAAKD,KAA3B;AACA,WACI,CAACC,SAAD,iBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAA2B,MAAA,OAAO,EAAE,KAAKQ,QAAzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CAFR;AAOH;;AAhDgC;;AAmDrC,eAAeV,YAAf","sourcesContent":["/*\r\n * File: PwaInstaller.js\r\n * Desc: pwa手动触发安装\r\n * File Created: 2018-11-07 21:13:18\r\n * Author: chenghao\r\n *\r\n * Copyright 2018 - present, chenghao\r\n */\r\nimport React, { Component } from 'react';\r\n\r\nclass PwaInstaller extends Component {\r\n    state = {\r\n        installed: true,\r\n    };\r\n    componentDidMount() {\r\n        window.addEventListener('beforeinstallprompt', this.beforeInstallPrompt);\r\n    }\r\n    componentWillUnmount() {\r\n        window.removeEventListener('beforeinstallprompt', this.beforeInstallPrompt);\r\n    }\r\n    deferredPrompt: any;\r\n    beforeInstallPrompt = (e: Event) => {\r\n        console.log('beforeinstallprompt Event fired');\r\n        // 未安装PWA应用\r\n        this.setState({ installed: false });\r\n\r\n        e.preventDefault();\r\n        // Stash the event so it can be triggered later.\r\n        this.deferredPrompt = e;\r\n        return false;\r\n    };\r\n    download = () => {\r\n        if (this.deferredPrompt !== undefined) {\r\n            // The user has had a postive interaction with our app and Chrome\r\n            // has tried to prompt previously, so let's show the prompt.\r\n            this.deferredPrompt.prompt();\r\n            // Follow what the user has done with the prompt.\r\n            this.deferredPrompt.userChoice.then((choiceResult: any) => {\r\n                console.log(choiceResult.outcome);\r\n                if (choiceResult.outcome === 'dismissed') {\r\n                    console.log('User cancelled home screen install');\r\n                } else {\r\n                    console.log('User added to home screen');\r\n                }\r\n                // We no longer need the prompt.  Clear it up.\r\n                this.deferredPrompt = null;\r\n            });\r\n        }\r\n    };\r\n    render() {\r\n        const { installed } = this.state;\r\n        return (\r\n            !installed && (\r\n                <div className=\"installer\" onClick={this.download}>\r\n                    <div className=\"installer__btn\" />\r\n                </div>\r\n            )\r\n        );\r\n    }\r\n}\r\n\r\nexport default PwaInstaller;\r\n"]},"metadata":{},"sourceType":"module"}