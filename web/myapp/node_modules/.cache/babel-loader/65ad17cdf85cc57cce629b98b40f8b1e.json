{"ast":null,"code":"import \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/notification/style\";\nimport _notification from \"antd/lib/notification\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nvar _jsxFileName = \"C:\\\\Users\\\\asus\\\\Desktop\\\\bysg\\\\web\\\\myapp\\\\src\\\\App.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport umbrella from 'umbrella-storage';\nimport { useAlita } from 'redux-alita';\nimport Routes from './routes';\nimport SiderCustom from './components/SiderCustom';\nimport HeaderCustom from './components/HeaderCustom';\nimport { ThemePicker, Copyright } from './components/widget';\nimport { checkLogin } from './utils';\nimport { fetchMenu } from './service';\nconst {\n  Content,\n  Footer\n} = _Layout;\n\nfunction checkIsMobile() {\n  const clientWidth = window.innerWidth;\n  return clientWidth <= 992;\n}\n\nlet _resizeThrottled = false;\n\nfunction resizeListener(handler) {\n  const delay = 250;\n\n  if (!_resizeThrottled) {\n    _resizeThrottled = true;\n    const timer = setTimeout(() => {\n      handler(checkIsMobile());\n      _resizeThrottled = false;\n      clearTimeout(timer);\n    }, delay);\n  }\n}\n\nfunction handleResize(handler) {\n  window.addEventListener('resize', resizeListener.bind(null, handler));\n}\n\nfunction openFNotification() {\n  const openNotification = () => {\n    _notification.open({\n      message: '博主-yezihaohao',\n      description: /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 43,\n          columnNumber: 21\n        }\n      }, \"GitHub\\u5730\\u5740\\uFF1A\", /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://github.com/yezihaohao\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 25\n        }\n      }, \"https://github.com/yezihaohao\")), /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 21\n        }\n      }, \"\\u535A\\u5BA2\\u5730\\u5740\\uFF1A\", /*#__PURE__*/React.createElement(\"a\", {\n        href: \"https://yezihaohao.github.io/\",\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 25\n        }\n      }, \"https://yezihaohao.github.io/\"))),\n      icon: /*#__PURE__*/React.createElement(_Icon, {\n        type: \"smile-circle\",\n        style: {\n          color: 'red'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 19\n        }\n      }),\n      duration: 0\n    });\n\n    umbrella.setLocalStorage('hideBlog', true);\n  };\n\n  const storageFirst = umbrella.getLocalStorage('hideBlog');\n\n  if (!storageFirst) {\n    openNotification();\n  }\n}\n/**\r\n * 获取服务端异步菜单\r\n * @param handler 执行回调\r\n */\n\n\nfunction fetchSmenu(handler) {\n  const setAlitaMenu = menus => {\n    handler(menus); // this.props.setAlitaState({ stateName: 'smenus', data: menus });\n  };\n\n  setAlitaMenu(umbrella.getLocalStorage('smenus') || []);\n  fetchMenu().then(smenus => {\n    setAlitaMenu(smenus);\n    umbrella.setLocalStorage('smenus', smenus);\n  });\n}\n\nconst App = props => {\n  const [collapsed, setCollapsed] = useState(false);\n  const [auth, responsive, setAlita] = useAlita({\n    auth: {\n      permissions: null\n    }\n  }, {\n    responsive: {\n      isMobile: false\n    }\n  }, {\n    light: true\n  });\n  useEffect(() => {\n    let user = umbrella.getLocalStorage('user');\n    user && setAlita('auth', user);\n    setAlita('responsive', {\n      isMobile: checkIsMobile()\n    });\n    handleResize(isMobile => setAlita('responsive', {\n      isMobile\n    }));\n    openFNotification();\n    fetchSmenu(smenus => setAlita('smenus', smenus));\n  }, [setAlita]);\n\n  function toggle() {\n    setCollapsed(!collapsed);\n  }\n\n  return /*#__PURE__*/React.createElement(_Layout, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, !responsive.isMobile && checkLogin(auth.permissions) && /*#__PURE__*/React.createElement(SiderCustom, {\n    collapsed: collapsed,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(ThemePicker, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(_Layout, {\n    className: \"app_layout\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(HeaderCustom, {\n    toggle: toggle,\n    collapsed: collapsed,\n    user: auth || {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Content, {\n    className: \"app_layout_content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Routes, {\n    auth: auth,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Footer, {\n    className: \"app_layout_foot\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Copyright, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 21\n    }\n  }))));\n};\n\nexport default App;","map":{"version":3,"sources":["C:/Users/asus/Desktop/bysg/web/myapp/src/App.tsx"],"names":["React","useState","useEffect","umbrella","useAlita","Routes","SiderCustom","HeaderCustom","ThemePicker","Copyright","checkLogin","fetchMenu","Content","Footer","checkIsMobile","clientWidth","window","innerWidth","_resizeThrottled","resizeListener","handler","delay","timer","setTimeout","clearTimeout","handleResize","addEventListener","bind","openFNotification","openNotification","open","message","description","icon","color","duration","setLocalStorage","storageFirst","getLocalStorage","fetchSmenu","setAlitaMenu","menus","then","smenus","App","props","collapsed","setCollapsed","auth","responsive","setAlita","permissions","isMobile","light","user","toggle"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Layout, notification, Icon } from 'antd';\r\nimport umbrella from 'umbrella-storage';\r\nimport { useAlita } from 'redux-alita';\r\nimport Routes from './routes';\r\nimport SiderCustom from './components/SiderCustom';\r\nimport HeaderCustom from './components/HeaderCustom';\r\nimport { ThemePicker, Copyright } from './components/widget';\r\nimport { checkLogin } from './utils';\r\nimport { fetchMenu } from './service';\r\n\r\nconst { Content, Footer } = Layout;\r\n\r\ntype AppProps = {};\r\n\r\nfunction checkIsMobile() {\r\n    const clientWidth = window.innerWidth;\r\n    return clientWidth <= 992;\r\n}\r\n\r\nlet _resizeThrottled = false;\r\nfunction resizeListener(handler: (isMobile: boolean) => void) {\r\n    const delay = 250;\r\n    if (!_resizeThrottled) {\r\n        _resizeThrottled = true;\r\n        const timer = setTimeout(() => {\r\n            handler(checkIsMobile());\r\n            _resizeThrottled = false;\r\n            clearTimeout(timer);\r\n        }, delay);\r\n    }\r\n}\r\nfunction handleResize(handler: (isMobile: boolean) => void) {\r\n    window.addEventListener('resize', resizeListener.bind(null, handler));\r\n}\r\n\r\nfunction openFNotification() {\r\n    const openNotification = () => {\r\n        notification.open({\r\n            message: '博主-yezihaohao',\r\n            description: (\r\n                <div>\r\n                    <p>\r\n                        GitHub地址：\r\n                        <a\r\n                            href=\"https://github.com/yezihaohao\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                        >\r\n                            https://github.com/yezihaohao\r\n                        </a>\r\n                    </p>\r\n                    <p>\r\n                        博客地址：\r\n                        <a\r\n                            href=\"https://yezihaohao.github.io/\"\r\n                            target=\"_blank\"\r\n                            rel=\"noopener noreferrer\"\r\n                        >\r\n                            https://yezihaohao.github.io/\r\n                        </a>\r\n                    </p>\r\n                </div>\r\n            ),\r\n            icon: <Icon type=\"smile-circle\" style={{ color: 'red' }} />,\r\n            duration: 0,\r\n        });\r\n        umbrella.setLocalStorage('hideBlog', true);\r\n    };\r\n    const storageFirst = umbrella.getLocalStorage('hideBlog');\r\n    if (!storageFirst) {\r\n        openNotification();\r\n    }\r\n}\r\n\r\n/**\r\n * 获取服务端异步菜单\r\n * @param handler 执行回调\r\n */\r\nfunction fetchSmenu(handler: any) {\r\n    const setAlitaMenu = (menus: any) => {\r\n        handler(menus);\r\n        // this.props.setAlitaState({ stateName: 'smenus', data: menus });\r\n    };\r\n    setAlitaMenu(umbrella.getLocalStorage('smenus') || []);\r\n    fetchMenu().then((smenus) => {\r\n        setAlitaMenu(smenus);\r\n        umbrella.setLocalStorage('smenus', smenus);\r\n    });\r\n}\r\n\r\nconst App = (props: AppProps) => {\r\n    const [collapsed, setCollapsed] = useState<boolean>(false);\r\n    const [auth, responsive, setAlita] = useAlita(\r\n        { auth: { permissions: null } },\r\n        { responsive: { isMobile: false } },\r\n        { light: true }\r\n    );\r\n\r\n    useEffect(() => {\r\n        let user = umbrella.getLocalStorage('user');\r\n        user && setAlita('auth', user);\r\n        setAlita('responsive', { isMobile: checkIsMobile() });\r\n\r\n        handleResize((isMobile: boolean) => setAlita('responsive', { isMobile }));\r\n        openFNotification();\r\n        fetchSmenu((smenus: any[]) => setAlita('smenus', smenus));\r\n    }, [setAlita]);\r\n\r\n    function toggle() {\r\n        setCollapsed(!collapsed);\r\n    }\r\n    return (\r\n        <Layout>\r\n            {!responsive.isMobile && checkLogin(auth.permissions) && (\r\n                <SiderCustom collapsed={collapsed} />\r\n            )}\r\n            <ThemePicker />\r\n            <Layout className=\"app_layout\">\r\n                <HeaderCustom toggle={toggle} collapsed={collapsed} user={auth || {}} />\r\n                <Content className=\"app_layout_content\">\r\n                    <Routes auth={auth} />\r\n                </Content>\r\n                <Footer className=\"app_layout_foot\">\r\n                    <Copyright />\r\n                </Footer>\r\n            </Layout>\r\n        </Layout>\r\n    );\r\n};\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}